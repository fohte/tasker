# TODO - Detailed Implementation Plan

## 1. フェーズ1: 基盤構築 & コアタスク機能

### 1.1. インフラ & プロジェクトセットアップ
- [x] 1.1.1. Cloudflare D1データベースインスタンスの設定
- [x] 1.1.2. Drizzle ORMの設定 (`drizzle.config.ts`, 接続設定)
- [x] 1.1.3. 初期データベーススキーマ定義 (`schema.ts`) - `tasks`テーブル
- [x] 1.1.4. Drizzleマイグレーションの実行 - `tasks`テーブル作成
- [ ] 1.1.5. Cloudflare Accessによる認証基本設定
- [x] 1.1.6. GraphQL APIの基本構造設定

### 1.2. タスク一覧機能 (MVPバージョン)
- **1.2.1. バックエンド:**
  - [x] 1.2.1.1. GraphQLクエリリゾルバ (`Query.tasks`) の実装
  - [x] 1.2.1.2. Drizzleを使ったタスク取得クエリの実装
- **1.2.2. フロントエンド:**
  - [x] 1.2.2.1. タスク一覧表示用Next.jsページコンポーネント (`app/page.tsx` または `app/tasks/page.tsx`) の作成
  - [x] 1.2.2.2. GraphQLクライアントを使ったデータ取得ロジックの実装
  - [x] 1.2.2.3. タスク項目コンポーネント (`src/components/TaskItem.tsx`) の作成
  - [ ] 1.2.2.4. タスク一覧のレンダリング実装
  - [ ] 1.2.2.5. Tailwind CSSとshadcn/uiを使ったスタイリング

### 1.3. タスク作成機能 (基本)
- **1.3.1. バックエンド:**
  - [x] 1.3.1.1. GraphQLミューテーションリゾルバ (`Mutation.createTask`) の実装
  - [x] 1.3.1.2. Drizzleを使ったタスク作成クエリの実装
  - [x] 1.3.1.3. 入力バリデーションの追加
- **1.3.2. フロントエンド:**
  - [ ] 1.3.2.1. タスク作成用入力フォームの追加
  - [ ] 1.3.2.2. フォーム送信ロジックの実装
  - [ ] 1.3.2.3. タスク作成後のUI更新実装 (再取得または楽観的更新)

## 2. フェーズ2: タスク詳細 & 機能拡張

### 2.1. タスク詳細表示
- **2.1.1. バックエンド:**
  - [x] 2.1.1.1. 単一タスク取得用GraphQLクエリリゾルバ (`Query.task`) の実装
  - [x] 2.1.1.2. タスク更新用GraphQLミューテーションリゾルバ (`Mutation.updateTask`) の実装
  - [x] 2.1.1.3. タスク削除用GraphQLミューテーションリゾルバ (`Mutation.deleteTask`) の実装
- **2.1.2. フロントエンド:**
  - [ ] 2.1.2.1. タスク詳細用動的ルートページ (`app/tasks/[id]/page.tsx`) の作成
  - [ ] 2.1.2.2. 特定タスクのデータ取得実装
  - [ ] 2.1.2.3. タスク詳細情報の表示実装
  - [ ] 2.1.2.4. タスク詳細更新機能の実装 (ステータス変更、タイトル/説明編集)
  - [ ] 2.1.2.5. タスク削除機能の実装
  - [ ] 2.1.2.6. タスク一覧から詳細ページへのナビゲーション実装

### 2.2. タスク検索機能
- **2.2.1. バックエンド:**
  - [x] 2.2.1.1. `Query.tasks`リゾルバに検索パラメータを追加
  - [x] 2.2.1.2. 検索条件に基づくタスクフィルタリングクエリの実装
- **2.2.2. フロントエンド:**
  - [ ] 2.2.2.1. 検索入力フィールドの追加
  - [ ] 2.2.2.2. 検索パラメータを含むデータ取得ロジックの更新
  - [ ] 2.2.2.3. 検索入力に応じたUIのリアルタイム更新実装 (デバウンス処理含む)

### 2.3. タスク表示モード
- **2.3.1. リスト表示:**
  - [ ] 2.3.1.1. リスト表示コンポーネントの実装
- **2.3.2. テーブル表示:**
  - [ ] 2.3.2.1. テーブル表示コンポーネントの実装
  - [ ] 2.3.2.2. カラムのソート機能実装
- **2.3.3. 表示切替機能:**
  - [ ] 2.3.3.1. 表示モード切替UIの実装
  - [ ] 2.3.3.2. ユーザー設定の保存機能

## 3. フェーズ3: 高度な機能

### 3.1. ラベル機能
- **3.1.1. バックエンド:**
  - [ ] 3.1.1.1. `labels`テーブルスキーマ定義 (id, name, color)
  - [ ] 3.1.1.2. `task_labels`中間テーブルスキーマ定義
  - [ ] 3.1.1.3. Drizzleマイグレーション実行
  - [ ] 3.1.1.4. ラベルCRUD用GraphQLリゾルバ実装
  - [ ] 3.1.1.5. タスク-ラベル関連付け用ミューテーション実装
  - [ ] 3.1.1.6. タスククエリでラベル情報を取得できるよう実装
- **3.1.2. フロントエンド:**
  - [ ] 3.1.2.1. ラベル管理UI実装 (作成、編集、削除)
  - [ ] 3.1.2.2. タスク項目・詳細ページでのラベル表示コンポーネント実装
  - [ ] 3.1.2.3. タスク詳細ページでのラベル追加・削除機能実装
  - [ ] 3.1.2.4. ラベルによるタスクフィルタリング機能実装

### 3.2. 親子関係管理
- **3.2.1. バックエンド:**
  - [ ] 3.2.1.1. `task_links`テーブルスキーマ定義 (parent_id, child_id, relation)
  - [ ] 3.2.1.2. Drizzleマイグレーション実行
  - [ ] 3.2.1.3. タスク作成・更新時に親子関係を扱えるよう実装
  - [ ] 3.2.1.4. タスククエリで関連タスク (親/子) を取得できるよう実装
- **3.2.2. フロントエンド:**
  - [ ] 3.2.2.1. タスク詳細ページでの親タスク表示と子タスク一覧表示
  - [ ] 3.2.2.2. 親子関係設定用UI実装

### 3.3. コメント・メモ機能
- **3.3.1. バックエンド:**
  - [ ] 3.3.1.1. `comments`テーブルスキーマ定義 (id, task_id, content, created_at)
  - [ ] 3.3.1.2. Drizzleマイグレーション実行
  - [ ] 3.3.1.3. コメントCRUD用GraphQLリゾルバ実装
- **3.3.2. フロントエンド:**
  - [ ] 3.3.2.1. タスク詳細ページへのコメントセクション追加
  - [ ] 3.3.2.2. コメント取得・表示の実装
  - [ ] 3.3.2.3. コメント投稿フォーム実装
  - [ ] 3.3.2.4. コメントの時系列表示実装

### 3.4. Issue管理機能
- **3.4.1. バックエンド:**
  - [ ] 3.4.1.1. `issues`テーブルスキーマ定義 (id, task_id, body, created_at, updated_at)
  - [ ] 3.4.1.2. Drizzleマイグレーション実行
  - [ ] 3.4.1.3. Issue CRUD用GraphQLリゾルバ実装
- **3.4.2. フロントエンド:**
  - [ ] 3.4.2.1. Issue一覧ページ実装
  - [ ] 3.4.2.2. Issue詳細ページ実装
  - [ ] 3.4.2.3. Issue作成・編集フォーム実装
  - [ ] 3.4.2.4. Issueとタスクの関連表示

## 4. フェーズ4: UI/UX強化とオプション機能

### 4.1. UI/UX改善
- [ ] 4.1.1. モバイルレスポンシブ対応の強化
- [ ] 4.1.2. 楽観的更新実装によるUI体感速度向上
- [ ] 4.1.3. ローディング状態とエラーハンドリングの実装
- [ ] 4.1.4. ネイティブアプリ風UXの実現
  - [ ] 4.1.4.1. View Transitions APIの実装
  - [ ] 4.1.4.2. スワイプジェスチャーの実装
  - [ ] 4.1.4.3. アニメーション・トランジションの洗練

### 4.2. フィルタリングとソート機能強化
- [ ] 4.2.1. 複合フィルタリング機能の実装
- [ ] 4.2.2. ソートオプションの拡充
- [ ] 4.2.3. フィルタ・ソート設定の保存機能

### 4.3. カレンダービュー
- [ ] 4.3.1. カレンダーコンポーネントの実装
- [ ] 4.3.2. タスクの締め切りをカレンダーに表示
- [ ] 4.3.3. カレンダーからのタスク作成・編集機能

### 4.4. オフライン対応
- [ ] 4.4.1. Service Workerの設定
- [ ] 4.4.2. オフラインデータキャッシュの実装
- [ ] 4.4.3. オフラインでの操作と同期機能の実装

### 4.5. (オプション) 外部連携
- [ ] 4.5.1. Todoist API連携調査と実装計画
- [ ] 4.5.2. 外部サービスとのデータ同期機構設計
- [ ] 4.5.3. 連携設定画面の実装

## 5. デプロイメントとメンテナンス

### 5.1. デプロイメント設定
- [ ] 5.1.1. Cloudflare Pagesへのデプロイ設定
- [ ] 5.1.2. CI/CDパイプラインの構築
- [ ] 5.1.3. 環境変数と機密情報の管理

### 5.2. 監視とロギング
- [ ] 5.2.1. エラー監視の設定
- [ ] 5.2.2. パフォーマンス監視の設定
- [ ] 5.2.3. ユーザー行動分析の実装 (任意)

### 5.3. メンテナンス計画
- [ ] 5.3.1. 定期的な依存関係更新の自動化
- [ ] 5.3.2. セキュリティスキャンの導入
- [ ] 5.3.3. バックアップ戦略の策定
